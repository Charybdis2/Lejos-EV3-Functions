Enjoy this mess of code lmao.